<!doctype html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<meta name="description" content="不超过150个字符"/>
<meta name="keywords" content=""/>
<meta name="author" content="name, sycbbb@sina.com"/>
<meta name="robots" content="index,follow"/>
<meta name="viewport" content="initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
<meta name="format-detection" content="telephone=no, email=no,adress=no"/>
<meta name="msapplication-tap-highlight" content="no">
<title>MERCIbnb木西民宿</title>
<link rel="stylesheet" href="../public/styles/hotel-list.css">
<link rel="stylesheet" href="../public/styles/iconfont.css">
<link rel="stylesheet" href="../public/styles/lib/dropload.css">
</head>
<body class="m-hotel">
<!-- begin header -->
<header class="public-header">
    <a href="#" class="left">
    	<i class="iconfont icon-fanhui"></i>
    </a>
  	<h1>家庭出游</h1>
  	<a href="#" class="right" id="click-g">
  		<i class="iconfont icon-sousuo"></i>
  	</a>
</header>
<!-- begin container -->
<div class="container">
  <div class="lists">
  <a href="detailed.html" class="hotel-list">
		<div class="img">
			<i class="iconfont icon-shoucang"></i>
			<img src="../public/images/hotel_list/hotel-list01.jpg" alt="">
			<h3><span>￥</span>888</h3>
			<p><span>摩登</span>青葱岁月，与友人共享</p>
		</div>
		<div class="text">
			<div class="text-top"><h3>隆翠豪宅</h3><p>5.0分 | 24评论</p></div>
			<p class="text-com"><span>欧美风格</span><span>干净舒适</span><span>交通便利</span></p>
			<p class="text-bottom">广州市天河区黄埔大道西108号（近石牌桥地铁站）</p>
		</div>
	</a>
	<a href="detailed.html" class="hotel-list hotel-list-order">
		<div class="img">
			<i class="iconfont icon-shoucang"></i>
			<img src="../public/images/hotel_list/hotel-list02.jpg" alt="">
			<div class="order"><img src="../public/images/hotel_list/order.png" alt=""></div>	
			<h3><span>￥</span>888</h3>
			<p><span>摩登</span>青葱岁月，与友人共享</p>
		</div>
		<div class="text">
			<div class="text-top"><h3>隆翠豪宅</h3><p>5.0分 | 24评论</p></div>
			<p class="text-com"><span>欧美风格</span><span>干净舒适</span><span>交通便利</span></p>
			<p class="text-bottom">广州市天河区黄埔大道西108号（近石牌桥地铁站）</p>
		</div>
	</a>
	<a href="detailed.html" class="hotel-list">
		<div class="img">
			<i class="iconfont icon-shoucang"></i>
			<img src="../public/images/hotel_list/hotel-list03.jpg" alt="">
			<h3><span>￥</span>888</h3>
			<p><span>摩登</span>青葱岁月，与友人共享</p>
		</div>
		<div class="text">
			<div class="text-top"><h3>隆翠豪宅</h3><p>5.0分 | 24评论</p></div>
			<p class="text-com"><span>欧美风格</span><span>干净舒适</span><span>交通便利</span></p>
			<p class="text-bottom">广州市天河区黄埔大道西108号（近石牌桥地铁站）</p>
		</div>
	</a>
  </div>	
</div>
<div class="g-page">	
	<header class="search-header">
		  <a href="javascript:;" class="left">
	    	<i class="iconfont icon-fanhui"></i>
	    </a>
	    <h1>搜索木西房源</h1>
	</header>
	<div class="g-page-text">
		<ul class="page-ul-list">
			<li class="li active">位置<i class="iconfont icon-sanjiao-copy"></i><i class="iconfont icon-sanjiao"></i></li>
			<li class="li">综合筛选<i class="iconfont icon-sanjiao-copy"></i><i class="iconfont icon-sanjiao"></i></li>
		</ul>
		<div class="g-page-all">
			<div class="g-page-list" style="display:block;">
          <dl class="g-areaList">
			        <dd>区域</dd>
			        <dd class="z-active">商圈</dd>
			        <dd>地铁</dd>
			        <dd>景点</dd>
			    </dl>
			    <div class="g-areaItem">
			    	<div class="g-areaItem-list">0</div>
			    	<div class="g-areaItem-list" style="display:block;">
                       <dl>
                       	<dd>不限</dd>
                       	<dd>天河体育商圈</dd>
                       	<dd>白云山风景区</dd>
                       	<dd>珠江新城商圈</dd>
                       	<dd>火车站商圈</dd>
                       	<dd>番禺长隆区域</dd>
                       	<dd>上下九步行街</dd>
                       	<dd>北京路</dd>
                       	<dd>北京路</dd>
                       	<dd>琶洲会展中心</dd>
                       	<dd>天河体育商圈</dd>
                       	<dd>白云山风景区</dd>
                       	<dd>珠江新城商圈</dd>
                       	<dd>火车站商圈</dd>
                       	<dd>番禺长隆区域</dd>
                       	<dd>上下九步行街</dd>
                       	<dd>北京路</dd>
                       	<dd>北京路</dd>
                       	<dd>琶洲会展中心</dd>
                       </dl>
			    	</div>
			    	<div class="g-areaItem-list">2</div>
			    	<div class="g-areaItem-list">4</div>
			    </div>
          <button class="g-areaItem-btn">确定</button> 
			</div>
			<div class="g-page-list">
				<div class="m-items m-items-t">
					<h3>价格</h3>
					<ul id="line-ul">
						<li>￥0</li>
						<li>￥500</li>
						<li>￥1000</li>
						<li>￥1500</li>
						<li>￥2000</li>
						<li>不限</li>
					</ul>
					<div class="line" id="line">
						<form method="post">
						    <input type="range" name="range" min="0" max="5" step="0" value="0" />
						    <!-- <output name="result">  </output> -->
						</form>			
					</div>

				</div>
				<div class="m-items m-items-b">
					<h3>排序</h3>
					<ul class="m-ul-c">
						<li>距离优先</li>
						<li>低价优先</li>
						<li>高价优先</li>
						<li>好评优先</li>
					</ul>
				</div>
				<div class="m-items m-items-b">
					<h3>户型</h3>
					<ul class="m-ul-b">
						<li>一室</li>
						<li>二室</li>
						<li>三室</li>
						<li>四室及以上</li>
					</ul>
				</div>
				<div class="m-items-fixed">
					<ul>
						<li id="empty">清空</li>
						<li>确定</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</div>
<div id="scroll">
  <i class="iconfont icon-zhiding"></i>
</div>
<!-- begin script -->
<!-- <script src="../public/scripts/require.js" data-main="../public/scripts/hotel-list"></script> -->
<script src="../public/scripts/lib/zepto.min.js"></script>
<script src="../public/scripts/lib/dropload.min.js"></script>
<script>
  $(document).ready(function () {

         var size=$(window).width()/10;
          $("html").css('fontSize',size);
          if($(window).width()>=640){
             $("html").css('fontSize','24px');
          }

          $("#click-g").on("click",function(){
              $(".g-page").show();
              $(".container").hide();
              $(".public-header").hide();
          });

          $(".search-header .left").on("click",function(){
               $(".g-page").hide();
                $(".container").show();
              $(".public-header").show();
          });

          $(".page-ul-list li").on("click",function(){
             $(this).addClass("active").siblings().removeClass("active");
             $(".g-page-all .g-page-list").eq($(this).index()).show().siblings().hide();
          });

          $(".g-areaList dd").on("click",function(){
             $(this).addClass("z-active").siblings().removeClass("z-active");
             $(".g-areaItem .g-areaItem-list").eq($(this).index()).show().siblings().hide();
          });

          $(".g-areaItem-list dl dd").on("click",function(){
              $(this).addClass("l-active").siblings().removeClass("l-active");
              if($(this).find("i").size()>=1){
                  return false;
              }else{   
                  $(this).append("<i class='iconfont icon-dagou'></i>").siblings().find("i").remove();
              }
          });

          (function() {
              var lineUl=document.getElementById("line-ul");
              var lineLi=lineUl.getElementsByTagName("li");   
              var empty=document.getElementById("empty");     
              var f = document.forms[0],
                  range = f['range'],
                  // result = f['result'],
                  cachedRangeValue = localStorage.rangeValue ? localStorage.rangeValue : 0; 

              // 检测浏览器是否是足够酷
              // 识别range input.
              var o = document.createElement('input');
              o.type = 'range';
              if ( o.type === 'text' ) alert('不好意思，你的浏览器还不够酷，试试最新的Opera浏览器吧。');

              // 设置初始值
              // 无论是否本地存储了，都设置值为0
              range.value = cachedRangeValue;
              // result.value = cachedRangeValue;

              // 当用户选择了个值，更新本地存储
              range.addEventListener("mouseup", function() {
                  console.log("你选择的值是：" + range.value + ". 我现在正在用本地存储保存此值。在现代浏览器上刷新并检测。");
                  localStorage ? (localStorage.rangeValue = range.value) : alert("数据保存到了数据库或是其他什么地方。");

              }, false);

              // 滑动时显示选择的值
              range.addEventListener("change", function() {
                  // result.value = range.value;
                  if(range.value==0){
                     lineLi[0].className="line-active"; 
                     lineLi[1].className="";
                     lineLi[2].className="";
                     lineLi[3].className="";
                     lineLi[4].className="";
                     lineLi[5].className="";
                  }
                  if(range.value==1){  
                    lineLi[0].className="line-active";                               
                    lineLi[1].className="line-active";
                    lineLi[2].className="";
                     lineLi[3].className="";
                     lineLi[4].className="";
                     lineLi[5].className="";
                  }
                  if(range.value==2){  
                    lineLi[0].className="line-active";                               
                    lineLi[1].className="line-active";                              
                    lineLi[2].className="line-active";
                    lineLi[3].className="";
                     lineLi[4].className="";
                     lineLi[5].className="";
                  }
                  if(range.value==3){    
                  lineLi[0].className="line-active";                               
                    lineLi[1].className="line-active";                              
                    lineLi[2].className="line-active";                            
                    lineLi[3].className="line-active";
                     lineLi[4].className="";
                     lineLi[5].className="";
                  }
                  if(range.value==4){   
                  lineLi[0].className="line-active";                               
                    lineLi[1].className="line-active";                              
                    lineLi[2].className="line-active";                            
                    lineLi[3].className="line-active";                             
                    lineLi[4].className="line-active";
                    lineLi[5].className="";
                  }
                  if(range.value==5){   
                    lineLi[0].className="line-active";                               
                    lineLi[1].className="line-active";                              
                    lineLi[2].className="line-active";                            
                    lineLi[3].className="line-active";                             
                    lineLi[4].className="line-active";                             
                    lineLi[5].className="line-active";
                  }
              }, false);

              //
              empty.onclick=function(){
                  range.value = cachedRangeValue;
                  lineLi[0].className="line-active"; 
                 lineLi[1].className="";
                 lineLi[2].className="";
                 lineLi[3].className="";
                 lineLi[4].className="";
                 lineLi[5].className="";
              }
          })();

          $("#empty").on("click",function(){
              $(".m-items li").removeClass("active");
          });

          $(".m-ul-c li").on("click",function(){
             $(this).addClass("active").siblings().removeClass("active");
          });
          $(".m-ul-b li").on("click",function(){
             $(this).addClass("active").siblings().removeClass("active");
          });
  });
  $(function(){
      var counter = 0;
      // 每页展示4个
      var num = 4;
      var pageStart = 0,pageEnd = 0;

      // dropload
      $('.container').dropload({
          scrollArea : window,
          loadDownFn : function(me){
              $.ajax({
                  type: 'GET',
                  url: '../public/scripts/json/more.json',
                  dataType: 'json',
                  success: function(data){
                      var result = '';
                      counter++;
                      pageEnd = num * counter;
                      pageStart = pageEnd - num;

                      for(var i = pageStart; i < pageEnd; i++){
                          result +=   '<a class="item opacity" href="'+data.lists[i].link+'">'
                                          +'<img src="'+data.lists[i].pic+'" alt="">'
                                          +'<h3>'+data.lists[i].title+'</h3>'
                                          +'<span class="date">'+data.lists[i].date+'</span>'
                                      +'</a>';
                          if((i + 1) >= data.lists.length){
                              // 锁定
                              me.lock();
                              // 无数据
                              me.noData();
                              break;
                          }
                      }
                      // 为了测试，延迟1秒加载
                      setTimeout(function(){
                          $('.lists').append(result);
                          // 每次数据加载完，必须重置
                          me.resetload();
                      },1000);
                  },
                  error: function(xhr, type){
                      alert('Ajax error!');
                      // 即使加载出错，也得重置
                      me.resetload();
                  }
              });
          }
      });
  });
</script>
<script>
  /*阻止ios拖拽到底部还能继续拖拽*/
  var ScrollFix = function(elem) {
        // Variables to track inputs
        var startY, startTopScroll;
        
        elem = elem || document.querySelector(elem);
        
        // If there is no element, then do nothing    
        if(!elem)
            return;

        // Handle the start of interactions
        elem.addEventListener('touchstart', function(event){
            startY = event.touches[0].pageY;
            startTopScroll = elem.scrollTop;
            
          if(startTopScroll <= 0)
              elem.scrollTop = 1;

          if(startTopScroll + elem.offsetHeight >= elem.scrollHeight)
              elem.scrollTop = elem.scrollHeight - elem.offsetHeight - 1;
      }, false);
  };

  /*判断设备调用ScrollFix*/

  var sUserAgent=navigator.userAgent.toLowerCase();
  if(sUserAgent.match(/iphone os/i) == "iphone os"){
      $('.g-areaItem-list').addClass('g-areaItem-list2');
      ScrollFix($('.g-areaItem-list2')[0]); 
  }

  /*阻止用户双击使屏幕上滑*/
  var agent = navigator.userAgent.toLowerCase();        //检测是否是ios
  var iLastTouch = null;                                //缓存上一次tap的时间
  if (agent.indexOf('iphone') >= 0 || agent.indexOf('ipad') >= 0)
  {
      document.body.addEventListener('touchend', function(event)
      {
          var iNow = new Date()
              .getTime();
          iLastTouch = iLastTouch || iNow + 1 /** 第一次时将iLastTouch设为当前时间+1 */ ;
          var delta = iNow - iLastTouch;
          if (delta < 500 && delta > 0)
          {
              event.preventDefault();
              return false;
          }
          iLastTouch = iNow;
      }, false);
  }
</script>
<script>
  // 获取置顶对象
  var obj = document.getElementById('scroll');
  // 置顶对象点击事件
  obj.onclick = function() {
    var timer = setInterval(function() {
      window.scrollBy(0, -50);
      if (document.body.scrollTop == 0) {
        clearInterval(timer);
      };
    }, 2);
  }
  // 窗口滚动检测
  window.onscroll = function() {
    obj.style.display = (document.body.scrollTop >= 300) ? "block" : "none";
  }
</script>
</body>
</html>